import { useState } from 'react';
import AuraCluster from './AuraCluster';
import Camera, { FacePositionType } from './Camera';

import './App.css';

const FADE_DURATION = 1000;

function App() {
  const [showCamera, setShowCamera] = useState<boolean>(false);
  const [facePosition, setFacePosition] = useState<FacePositionType | null>(
    null
  );

  const [fadeOutStartButton, setFadeOutStartButton] = useState<boolean>(false);

  const handleButtonClick = () => {
    setFadeOutStartButton(true);
    setTimeout(() => {
      setShowCamera(true);
      setFadeOutStartButton(false);
    }, FADE_DURATION);
  };

  return (
    <div className="page-wrapper">
      <header>
        <div className="lil-border" />
        <nav>
          <h1>URâ€“AURA</h1>
          <p>your energy, colorized</p>
        </nav>
      </header>

      <div className="camera-wrapper">
        {showCamera ? (
          <Camera
            facePosition={facePosition}
            setFacePosition={setFacePosition}
          />
        ) : (
          <div
            className={`start-camera ${fadeOutStartButton ? 'fade-out' : ''}`}
            style={{ transitionDuration: `${FADE_DURATION}ms` }}
          >
            <svg
              width="922"
              height="922"
              viewBox="0 0 922 922"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <mask id="path-1-inside-1_167_2258" fill="white">
                <path d="M461 0L467.273 341.304L509.188 2.52542L479.75 342.616L556.847 10.0739L492.022 345.224L603.457 22.563L503.954 349.101L648.506 39.8555L515.415 354.204L691.5 61.7623L526.28 360.477L731.969 88.0432L536.43 367.851L769.469 118.41L545.754 376.246L803.59 152.531L554.149 385.57L833.957 190.031L561.523 395.72L860.238 230.5L567.796 406.585L882.144 273.494L572.899 418.046L899.437 318.543L576.776 429.978L911.926 365.153L579.384 442.25L919.475 412.812L580.696 454.727L922 461L580.696 467.273L919.475 509.188L579.384 479.75L911.926 556.847L576.776 492.022L899.437 603.457L572.899 503.954L882.144 648.506L567.796 515.415L860.238 691.5L561.523 526.28L833.957 731.969L554.149 536.43L803.59 769.469L545.754 545.754L769.469 803.59L536.43 554.149L731.969 833.957L526.28 561.523L691.5 860.238L515.415 567.796L648.506 882.144L503.954 572.899L603.457 899.437L492.022 576.776L556.847 911.926L479.75 579.384L509.188 919.475L467.273 580.696L461 922L454.727 580.696L412.812 919.475L442.25 579.384L365.153 911.926L429.978 576.776L318.543 899.437L418.046 572.899L273.494 882.144L406.585 567.796L230.5 860.238L395.72 561.523L190.031 833.957L385.57 554.149L152.531 803.59L376.246 545.754L118.41 769.469L367.851 536.43L88.0432 731.969L360.477 526.28L61.7623 691.5L354.204 515.415L39.8555 648.506L349.101 503.954L22.563 603.457L345.224 492.022L10.0739 556.847L342.616 479.75L2.52542 509.188L341.304 467.273L0 461L341.304 454.727L2.52542 412.812L342.616 442.25L10.0739 365.153L345.224 429.978L22.563 318.543L349.101 418.046L39.8555 273.494L354.204 406.585L61.7623 230.5L360.477 395.72L88.0432 190.031L367.851 385.57L118.41 152.531L376.246 376.246L152.531 118.41L385.57 367.851L190.031 88.0432L395.72 360.477L230.5 61.7623L406.585 354.204L273.494 39.8555L418.046 349.101L318.543 22.563L429.978 345.224L365.153 10.0739L442.25 342.616L412.812 2.52542L454.727 341.304L461 0Z" />
              </mask>
              <path
                d="M461 0L467.273 341.304L509.188 2.52542L479.75 342.616L556.847 10.0739L492.022 345.224L603.457 22.563L503.954 349.101L648.506 39.8555L515.415 354.204L691.5 61.7623L526.28 360.477L731.969 88.0432L536.43 367.851L769.469 118.41L545.754 376.246L803.59 152.531L554.149 385.57L833.957 190.031L561.523 395.72L860.238 230.5L567.796 406.585L882.144 273.494L572.899 418.046L899.437 318.543L576.776 429.978L911.926 365.153L579.384 442.25L919.475 412.812L580.696 454.727L922 461L580.696 467.273L919.475 509.188L579.384 479.75L911.926 556.847L576.776 492.022L899.437 603.457L572.899 503.954L882.144 648.506L567.796 515.415L860.238 691.5L561.523 526.28L833.957 731.969L554.149 536.43L803.59 769.469L545.754 545.754L769.469 803.59L536.43 554.149L731.969 833.957L526.28 561.523L691.5 860.238L515.415 567.796L648.506 882.144L503.954 572.899L603.457 899.437L492.022 576.776L556.847 911.926L479.75 579.384L509.188 919.475L467.273 580.696L461 922L454.727 580.696L412.812 919.475L442.25 579.384L365.153 911.926L429.978 576.776L318.543 899.437L418.046 572.899L273.494 882.144L406.585 567.796L230.5 860.238L395.72 561.523L190.031 833.957L385.57 554.149L152.531 803.59L376.246 545.754L118.41 769.469L367.851 536.43L88.0432 731.969L360.477 526.28L61.7623 691.5L354.204 515.415L39.8555 648.506L349.101 503.954L22.563 603.457L345.224 492.022L10.0739 556.847L342.616 479.75L2.52542 509.188L341.304 467.273L0 461L341.304 454.727L2.52542 412.812L342.616 442.25L10.0739 365.153L345.224 429.978L22.563 318.543L349.101 418.046L39.8555 273.494L354.204 406.585L61.7623 230.5L360.477 395.72L88.0432 190.031L367.851 385.57L118.41 152.531L376.246 376.246L152.531 118.41L385.57 367.851L190.031 88.0432L395.72 360.477L230.5 61.7623L406.585 354.204L273.494 39.8555L418.046 349.101L318.543 22.563L429.978 345.224L365.153 10.0739L442.25 342.616L412.812 2.52542L454.727 341.304L461 0Z"
                stroke="white"
                strokeWidth="21.1145"
                mask="url(#path-1-inside-1_167_2258)"
              />
            </svg>

            <button onClick={handleButtonClick}>click to open camera</button>
          </div>
        )}
      </div>

      {facePosition !== null && <AuraCluster facePosition={facePosition} />}

      {showCamera && (
        <footer>
          <svg
            width="334"
            height="338"
            viewBox="0 0 167 169"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            // pause video on click
          >
            <path
              d="M81.4218 118.783L83.5 153.027L85.5782 118.783C85.8341 114.566 91.59 113.552 93.2727 117.426L106.938 148.895L97.1784 116.005C95.9767 111.955 101.038 109.033 103.945 112.098L127.549 136.995L107.129 109.427C104.614 106.032 108.371 101.555 112.151 103.441L142.847 118.764L114.229 99.8418C110.705 97.5118 112.704 92.0196 116.901 92.4998L150.986 96.3997L117.623 88.4066C113.515 87.4223 113.515 81.5777 117.623 80.5934L150.986 72.6003L116.901 76.5002C112.704 76.9804 110.705 71.4882 114.229 69.1582L142.847 50.2363L112.151 65.5586C108.371 67.4454 104.614 62.9681 107.129 59.5734L127.549 32.005L103.945 56.9017C101.038 59.9674 95.9767 57.0451 97.1784 52.9951L106.938 20.1053L93.2727 51.5735C91.59 55.4485 85.8341 54.4336 85.5782 50.2168L83.5 15.9726L81.4218 50.2168C81.1659 54.4336 75.41 55.4485 73.7273 51.5735L60.0622 20.1053L69.8216 52.9951C71.0233 57.0451 65.9617 59.9674 63.0552 56.9017L39.4514 32.005L59.8712 59.5734C62.3857 62.9681 58.6288 67.4454 54.849 65.5586L24.1535 50.2363L52.7708 69.1582C56.2946 71.4882 54.2957 76.9804 50.0985 76.5002L16.0137 72.6003L49.3768 80.5934C53.485 81.5777 53.485 87.4223 49.3768 88.4066L16.0137 96.3997L50.0985 92.4998C54.2956 92.0196 56.2947 97.5118 52.7708 99.8418L24.1535 118.764L54.849 103.441C58.6288 101.555 62.3856 106.032 59.8712 109.427L39.4514 136.995L63.0552 112.098C65.9617 109.033 71.0233 111.955 69.8216 116.005L60.0622 148.895L73.7273 117.426C75.41 113.551 81.1659 114.566 81.4218 118.783Z"
              stroke="#fff"
              strokeWidth="2"
            />
          </svg>
        </footer>
      )}
    </div>
  );
}

export default App;
